const axios = require('axios');

async function createSecretGist(markdownContent, projectTitle) {
  const response = await axios.post('https://api.github.com/gists', {
    description: 'Project Summary',
    files: {
      [`${projectTitle}.md`]: {
        content: markdownContent
      }
    },
    public: false
  }, {
    headers: {
      'Authorization': `token YOUR_GITHUB_TOKEN`
    }
  });

  return response.data.html_url;
}

// Example usage:
app.post('/projects/:id/export', async (req, res) => {
  const project = projects.find(p => p.projectId === req.params.id);
  if (!project) {
    return res.status(404).send('Project not found');
  }
  const markdownContent = generateMarkdown(project);
  try {
    const gistUrl = await createSecretGist(markdownContent, project.title);
    res.json({ gistUrl });
  } catch (error) {
    res.status(500).send('Failed to create gist');
  }
});
